/**

Below is a network read defined in 3 messages.  First we see the NetFlow Object defined.  Notice the format of the remote address;
provided is the hostname, if available, and then ip address.

**/ 

{
  "datum" : {
    "com.bbn.tc.schema.avro.NetFlowObject" : {
      "uuid" : "00000000-0000-0000-0000-000000007BB5",
      "baseObject" : {
        "permission" : null,
        "epoch" : null,
        "properties" : null
      },
      "localAddress" : "10.10.202.44",
      "localPort" : 45741,
      "remoteAddress" : "dict.org 216.18.20.172",
      "remotePort" : 2628,
      "ipProtocol" : {
        "int" : 0
      },
      "fileDescriptor" : null
    }
  },
  "CDMVersion" : "17",
  "source" : "SOURCE_ANDROID_JAVA_CLEARSCOPE"
}

/**

The next messages defines the provenance tag node that will be applied to all data read from the network.

It includes the NetFlow object above.

**/

{
  "datum" : {
    "com.bbn.tc.schema.avro.ProvenanceTagNode" : {
      "tagId" : "00000000-0000-0000-0000-000000007BB6",
      "flowObject" : {
        "com.bbn.tc.schema.avro.UUID" : "00000000-0000-0000-0000-000000007BB5"
      },
      "subject" : "00000000-0000-0000-0000-000000007B0D",
      "systemCall" : {
        "string" : "int libcore.io.Posix.recvfrom(FileDescriptor fd, byte[] bytes, int byteOffset, int byteCount, int flags, InetSocketAddress srcAddress) [line: 553]"
      },
      "programPoint" : {
        "string" : "void edu.mit.clearscope.basicops.App1BasicOpsTask.readFromSocketWriteToFile(java.lang.String,int,java.io.File) [line: 322]"
      },
      "prevTagId" : null,
      "opcode" : null,
      "tagIds" : null,
      "itag" : null,
      "ctag" : null,
      "properties" : null
    }
  },
  "CDMVersion" : "17",
  "source" : "SOURCE_ANDROID_JAVA_CLEARSCOPE"
}

/**

Here is the event for the recvfrom, things to notice:

1. The first descriptor parameter is marked as control, and the values of the complex data type
are provided hierarchically.

2. The bytes read are provided as raw byte values.  The tag above is attached to the byte array.

3. The return value is provided last in the list of parameters.  It is marked as a source, with the name
"r".

**/

{
  "datum" : {
    "com.bbn.tc.schema.avro.Event" : {
      "uuid" : "B15687D8-BFEE-C02F-20EB-65DCF5A66BD4",
      "sequence" : 68,
      "type" : "EVENT_RECVFROM",
      "threadId" : 175,
      "subject" : "00000000-0000-0000-0000-000000007B0D",
      "predicateObject" : {
        "com.bbn.tc.schema.avro.UUID" : "00000000-0000-0000-0000-000000007BB5"
      },
      "predicateObjectPath" : null,
      "predicateObject2" : null,
      "predicateObject2Path" : null,
      "timestampNanos" : 1490822608805000000,
      "name" : {
        "string" : "int libcore.io.Posix.recvfrom(FileDescriptor fd, byte[] bytes, int byteOffset, int byteCount, int flags, InetSocketAddress srcAddress) [line: 553]"
      },
      "parameters" : {
        "array" : [ {
          "size" : -1,
          "type" : "VALUE_TYPE_CONTROL",
          "valueDataType" : "VALUE_DATA_TYPE_COMPLEX",
          "isNull" : false,
          "name" : {
            "string" : "fd"
          },
          "runtimeDataType" : {
            "string" : "java.io.FileDescriptor"
          },
          "valueBytes" : null,
          "tag" : null,
          "components" : {
            "array" : [ {
              "size" : -1,
              "type" : "VALUE_TYPE_CONTROL",
              "valueDataType" : "VALUE_DATA_TYPE_INT",
              "isNull" : false,
              "name" : {
                "string" : "descriptor"
              },
              "runtimeDataType" : null,
              "valueBytes" : {
                "bytes" : "00000015"
              },
              "tag" : {
                "array" : [ {
                  "numValueElements" : -1,
                  "tagId" : "00000000-0000-0000-0000-000000000000"
                } ]
              },
              "components" : null
            } ]
          }
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_SRC",
          "valueDataType" : "VALUE_DATA_TYPE_BYTE",
          "isNull" : false,
          "name" : {
            "string" : "bytes"
          },
          "runtimeDataType" : null,
          "valueBytes" : {
            "bytes" : "3232302070616E2E616C6570686E756C6C2E636F6D20646963746420312E31322E312F7266206F6E204C696E757820342E342E302D312D616D643634203C617574682E6D696D653E203C34303931343537312E363835392E313439303832323630384070616E2E616C6570686E756C6C2E636F6D3E0D0A000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"
          },
          "tag" : {
            "array" : [ {
              "numValueElements" : 119,
              "tagId" : "00000000-0000-0000-0000-000000007BB6"
            }, {
              "numValueElements" : 8073,
              "tagId" : "00000000-0000-0000-0000-000000000000"
            } ]
          },
          "components" : null
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_CONTROL",
          "valueDataType" : "VALUE_DATA_TYPE_INT",
          "isNull" : false,
          "name" : {
            "string" : "byteOffset"
          },
          "runtimeDataType" : null,
          "valueBytes" : {
            "bytes" : "00000000"
          },
          "tag" : {
            "array" : [ {
              "numValueElements" : -1,
              "tagId" : "00000000-0000-0000-0000-000000000000"
            } ]
          },
          "components" : null
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_CONTROL",
          "valueDataType" : "VALUE_DATA_TYPE_INT",
          "isNull" : false,
          "name" : {
            "string" : "byteCount"
          },
          "runtimeDataType" : null,
          "valueBytes" : {
            "bytes" : "00002000"
          },
          "tag" : {
            "array" : [ {
              "numValueElements" : -1,
              "tagId" : "00000000-0000-0000-0000-000000000000"
            } ]
          },
          "components" : null
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_CONTROL",
          "valueDataType" : "VALUE_DATA_TYPE_INT",
          "isNull" : false,
          "name" : {
            "string" : "flags"
          },
          "runtimeDataType" : null,
          "valueBytes" : {
            "bytes" : "00000000"
          },
          "tag" : {
            "array" : [ {
              "numValueElements" : -1,
              "tagId" : "00000000-0000-0000-0000-000000000000"
            } ]
          },
          "components" : null
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_CONTROL",
          "valueDataType" : "VALUE_DATA_TYPE_COMPLEX",
          "isNull" : true,
          "name" : {
            "string" : "srcAddress"
          },
          "runtimeDataType" : {
            "string" : "java.net.InetSocketAddress"
          },
          "valueBytes" : null,
          "tag" : null,
          "components" : null
        }, {
          "size" : -1,
          "type" : "VALUE_TYPE_SRC",
          "valueDataType" : "VALUE_DATA_TYPE_INT",
          "isNull" : false,
          "name" : {
            "string" : "r"
          },
          "runtimeDataType" : null,
          "valueBytes" : {
            "bytes" : "00000077"
          },
          "tag" : {
            "array" : [ {
              "numValueElements" : -1,
              "tagId" : "00000000-0000-0000-0000-000000007BB6"
            } ]
          },
          "components" : null
        } ]
      },
      "location" : null,
      "size" : null,
      "programPoint" : {
        "string" : "void edu.mit.clearscope.basicops.App1BasicOpsTask.readFromSocketWriteToFile(java.lang.String,int,java.io.File) [line: 322]"
      },
      "properties" : null
    }
  },
  "CDMVersion" : "17",
  "source" : "SOURCE_ANDROID_JAVA_CLEARSCOPE"
}
